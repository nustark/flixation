{"ast":null,"code":"import _classCallCheck from \"/Users/thurman/CS/React/streams/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/thurman/CS/React/streams/client/node_modules/@babel/runtime/helpers/esm/createClass\";\n\n/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { NotImplementedException } from '../utils/exception.js';\nexport var LoaderStatus = {\n  kIdle: 0,\n  kConnecting: 1,\n  kBuffering: 2,\n  kError: 3,\n  kComplete: 4\n};\nexport var LoaderErrors = {\n  OK: 'OK',\n  EXCEPTION: 'Exception',\n  HTTP_STATUS_CODE_INVALID: 'HttpStatusCodeInvalid',\n  CONNECTING_TIMEOUT: 'ConnectingTimeout',\n  EARLY_EOF: 'EarlyEof',\n  UNRECOVERABLE_EARLY_EOF: 'UnrecoverableEarlyEof'\n};\n/* Loader has callbacks which have following prototypes:\n *     function onContentLengthKnown(contentLength: number): void\n *     function onURLRedirect(url: string): void\n *     function onDataArrival(chunk: ArrayBuffer, byteStart: number, receivedLength: number): void\n *     function onError(errorType: number, errorInfo: {code: number, msg: string}): void\n *     function onComplete(rangeFrom: number, rangeTo: number): void\n */\n\nexport var BaseLoader =\n/*#__PURE__*/\nfunction () {\n  function BaseLoader(typeName) {\n    _classCallCheck(this, BaseLoader);\n\n    this._type = typeName || 'undefined';\n    this._status = LoaderStatus.kIdle;\n    this._needStash = false; // callbacks\n\n    this._onContentLengthKnown = null;\n    this._onURLRedirect = null;\n    this._onDataArrival = null;\n    this._onError = null;\n    this._onComplete = null;\n  }\n\n  _createClass(BaseLoader, [{\n    key: \"destroy\",\n    value: function destroy() {\n      this._status = LoaderStatus.kIdle;\n      this._onContentLengthKnown = null;\n      this._onURLRedirect = null;\n      this._onDataArrival = null;\n      this._onError = null;\n      this._onComplete = null;\n    }\n  }, {\n    key: \"isWorking\",\n    value: function isWorking() {\n      return this._status === LoaderStatus.kConnecting || this._status === LoaderStatus.kBuffering;\n    }\n  }, {\n    key: \"open\",\n    // pure virtual\n    value: function open(dataSource, range) {\n      throw new NotImplementedException('Unimplemented abstract function!');\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      throw new NotImplementedException('Unimplemented abstract function!');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this._type;\n    }\n  }, {\n    key: \"status\",\n    get: function get() {\n      return this._status;\n    }\n  }, {\n    key: \"needStashBuffer\",\n    get: function get() {\n      return this._needStash;\n    }\n  }, {\n    key: \"onContentLengthKnown\",\n    get: function get() {\n      return this._onContentLengthKnown;\n    },\n    set: function set(callback) {\n      this._onContentLengthKnown = callback;\n    }\n  }, {\n    key: \"onURLRedirect\",\n    get: function get() {\n      return this._onURLRedirect;\n    },\n    set: function set(callback) {\n      this._onURLRedirect = callback;\n    }\n  }, {\n    key: \"onDataArrival\",\n    get: function get() {\n      return this._onDataArrival;\n    },\n    set: function set(callback) {\n      this._onDataArrival = callback;\n    }\n  }, {\n    key: \"onError\",\n    get: function get() {\n      return this._onError;\n    },\n    set: function set(callback) {\n      this._onError = callback;\n    }\n  }, {\n    key: \"onComplete\",\n    get: function get() {\n      return this._onComplete;\n    },\n    set: function set(callback) {\n      this._onComplete = callback;\n    }\n  }]);\n\n  return BaseLoader;\n}();","map":null,"metadata":{},"sourceType":"module"}